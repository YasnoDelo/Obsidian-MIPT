# Коннекторы
## 1. SFP (Small Form-factor Pluggable)

- **Скорость**: до 1 Gbps (обычно 100 Mbps или 1 Gbps)
- **Расстояние**:
    - SX (850 nm, MMF) — до 550 м
    - LX (1310 nm, SMF) — до 10 км
- **Коннектор**: LC (две линии)
- **Примеры применения**:
    - Подключение 1 Gbps к серверу или свитчу.
    - Дешёвые MMF-линии на коротких кабелях.
- ## 2. SFP+
- **Скорость**: 10 Gbps
- **Совместимость**: в физических слотах SFP+, но классический SFP+ нельзя вставлять в SFP-порт и получить 1 G.
- **Расстояние/волокно**: как у SFP-LX/SX, но для 10 G.
- **Пример**: uplink 10 Gbps между ядровыми свитчами.
## 3. SFP28
- **Скорость**: 25 Gbps
- **Использование**: в современных топ-оф-рейков для 25 GbE, напрямую к серверам, где требуют большой плотности портов.
## 4. QSFP (Quad SFP)
- **Форм-фактор** «четырёхпортовый» — внутри 4×10 G или 4×25 G
- **Модификации**:
    - **QSFP+** — 4×10 Gbps → 40 Gbps aggregate.
    - **QSFP28** — 4×25 Gbps → 100 Gbps.
    - **QSFP56** — 4×50 Gbps → 200 Gbps (для 200G-портов).
- **Коннектор**: MPO/MTP (12- или 8-волоконный).
- **Применение**: магистрали между свитчами, spine-leaf архитектуры.
## 5. CFP / CFP2 / CFP4
- **Скорость**: 100 Gbps и выше (CFP4 — компактнее).
- **Расстояние**: до 80 км по SMF (CWDM/DWDM варианты).
- **Коннектор**: LC или MPO (в DWDM часто LC).
- **Использование**: провайдерские DWDM-магистрали, высокоскоростные агрегации.
## Multimode/Singlemode
## 1. Диаметр сердцевины

- **Single-Mode**: ~ 8–10 µm
- **Multimode**: 50 µm (OM2/OM3) или 62.5 µm (старые стандарты)
**Итог**: в MMF через сердцевину проходят сразу **сотни** световых лучей (мод), а в SMF — **одна** мода.
## 2. Моды распространения
- **Single-Mode**: только **основной** мод (LP₀₁)
- **Multimode**: множество мод (LP₀₁, LP₁₁, LP₂₁ и т.д.), каждый идёт разным путём и с разной скоростью.
**Итог**: в MMF возникает **дисперсия мод** — разные лучи приходят с разной задержкой.
## 3. Полоса пропускания и дальность

| Технология  | MMF OM2/OM3              | SMF (e.g. OS2) |
| ----------- | ------------------------ | -------------- |
| 10 Gb/s     | до 300 м / 550 м         | до 10–40 км    |
| 40/100 Gb/s | OM3 ~ 150 м, OM4 ~ 400 м | до 80–120 км   |
| 400 Gb/s    | OM4 ~ 100 м              | до 40 км       |

# NAT/PAT
| Тип                    | Что меняется                                | Когда удобно                            |
| ---------------------- | ------------------------------------------- | --------------------------------------- |
| **Static NAT**         | один-к-одному: внутренний ↔ внешний IP      | Когда нужен постоянный доступ к серверу |
| **Dynamic NAT**        | частная → пул внешних IP (один-к-одному)    | Ограниченный пул «белых» адресов        |
| **PAT (NAT overload)** | частная:порт → внешнийIP:порт (many-to-one) | Множество хостов за одним IP            |
В **PAT** при параллельных ICMP запросах роляет ICMP Identifier

# STP
Proposal-agreement
#Algorythm 
0) Root is chosen like in STP
1) Root blocks all ports for users
2) Root sends proposal messages
3) All routers block all ports for traffic except of port, which received  proposal message and send agreement back
4) 2 lvl [[Switch|switches]] repeat algorythm 
##### PVSTP
[[VLAN]] added (own tree for every [[VLAN]])
##### PVSTP+
[[VLAN#^c400a0|IEEE 802.1q]] support added
##### Rapid PVSTP
RSTP for each [[VLAN]]
##### MSTP
Multiple STP (we can make groups of [[VLAN|VLANs]] in one instance)


### Чем LACP лучше ручной агрегации?
При проведении PortChannel к двум разным устройствал LACP будет работать ,а  Etherchannel - нет. LACP отслеживает одинаковость параметров линков, так что разные железки будут дружить
### Два DHCP
про два DHCP сервера - там же вроде оба получают discover от пользователя, каждый отправляет offer, а пользователь пользуется первым одобренным (первый пришедший, который отвечает политике клиента) и потом просто говорит в request, какой у него адрес

# OSPF

### 1. Best-Path Selection

1. **Cost** = сумма метрик по наикратчайшему пути (Dijkstra).
2. **Типы LSA**:
- Intra-area (Type 1/2) дешевле inter-area (Type 3/4), а inter-area дешевле external (Type 5).

### Чем в OSPF E1/E2 отличается?
вроде E1 учитывает в метрике расстояние внутри AS и складывает с метрикой на ASBR до внешнего маршрута то есть есть маршрут до 1.1.1.0/24 с внешней метрикой 25 через роутер, до которого внутренняя метрика 25 и есть такой же с внешней 15 и внутренней 36. в итоге пойдёт по первому, так как у него меньше сумма метрик

а E2 считает отдельно внутреннюю и отдельно внешнюю, приоритезируя внешнюю ( в прошлом примере выберется второй путь)

### 2. Специальные зоны

- **Stub Area**
	- **Не ввозит** Type 5 (external), **ввозит** Type 3 (inter-area).
	- Вместо внешних маршрутов ABR рассылает **default-route** (0.0.0.0/0).
- **Totally Stubby Area (Cisco)**
	- **Не ввозит** ни Type 3, ни Type 5.
	- Видит только intra-area + **один** default.	
- **NSSA (Not-So-Stubby Area)**
	- **Не ввозит** Type 5, **ввозит** Type 3.
	- **ASBR внутри зоны** может делать `redistribute` → **Type 7** внутри NSSA.
	- ABR конвертит Type 7 → Type 5 для всего остального OSPF.	
- **Totally NSSA (Cisco)**
	- Как NSSA, но **не ввозит** Type 3 тоже (только intra-area + Type 7 + default).


# BGP:
Best-path-selection
1. Максимальное значение Weight (локально для маршрутизатора, только для Cisco)
2. Максимальное значение Local Preference (для всей AS)
3. Предпочесть локальный маршрут маршрутизатора (next hop = 0.0.0.0)
4. Кратчайший путь через автономные системы. (самый короткий AS_PATH)
5. Минимальное значение Origin Code (IGP < EGP < incomplete)
6. Минимальное значение MED (распространяется между автономными системами)
7. Путь eBGP лучше чем путь iBGP
8. Выбрать путь через ближайшего IGP-соседа.  
    Если это условие выполнено, то происходит балансировка нагрузки между несколькими равнозначными линками Следующие условия могут различаться от вендора к вендору.
9. Выбрать самый старый маршрут для eBGP-пути
10. Выбрать путь через соседа с наименьшим BGP router ID
11. Выбрать путь через соседа с наименьшим IP-адресом

### Какими атрибутами манипулировать входящим трафиком в  BGP? А исходящим?
##### К нам:
AS-Path Prepend/MED (Multi-Exit Discriminator),BGP-Community
##### От нас:
Local_Pref, **Weight** (только Cisco)

### Собственно защита от петель в I/eBGP
в eBGP проверяется наличие своей AS в AS-path
а в iBGP улучшенный split horizon, который вообще не разрешает переанонсировать маршруты соседям по iBGP (тогда нужна full-mesh)
если full-mesh нет, то используется route reflector (который добавляет в анонс свой cluster-ID) или AS делится на subAS 100:1, 100:2 и между ними всё бегает по правилам eBGP, а внутри - улучшенный split horizon